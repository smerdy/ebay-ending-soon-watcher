"use strict";function convertMS(e){var r,t,i,o;return o=Math.floor(e/1e3),i=Math.floor(o/60),o%=60,t=Math.floor(i/60),i%=60,r=Math.floor(t/24),t%=24,{d:r,h:t,m:i,s:o}}var trim=require("trim"),ebay=require("ebay-api"),request=require("request"),cheerio=require("cheerio"),fs=require("fs"),moment=require("moment"),ebayConfig=JSON.parse(fs.readFileSync("src/config.json")).ebay;module.exports=function(e,r,t){var i={keywords:e.query.split(" "),paginationInput:{entriesPerPage:10},itemFilter:[{name:"MaxPrice",value:"900"},{name:"MinPrice",value:"350"}],sortOrder:"EndingTimeSoonest"};ebay.xmlRequest({serviceName:"Finding",opType:"findItemsByKeywords",devId:ebayConfig.devId,certId:ebayConfig.certId,appId:ebayConfig.appId,authToken:ebayConfig.authToken,params:i,parser:ebay.parseResponseJson},function(e,i){if(e)throw e;var o=i.searchResult.item;console.log("Found",o.length,"items");var a=o.map(function(e){var t=moment.duration(e.sellingStatus.timeLeft);return!(t.asMilliseconds()>36e5*r)&&{title:e.title,price:e.sellingStatus.currentPrice.amount,hoursLeft:t.asHours(),picURL:e.galleryURL,url:e.viewItemURL}}).filter(Boolean);console.log(a),t(a)})};
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}var _mailer=require("./../src/mailer"),_mailer2=_interopRequireDefault(_mailer),_ebayFetch=require("./../src/ebayFetch"),_ebayFetch2=_interopRequireDefault(_ebayFetch),CronJob=require("cron").CronJob,hour_gap=72,ebayOptions={query:"fujifilm x-t1",price_low:300,price_high:400},job=new CronJob("0-59/10 * * * * *",function(){(0,_ebayFetch2["default"])(ebayOptions,hour_gap,function(e){if(e.length>0){var r=e.map(function(e){return'<a href="'+e.url+'">'+e.title+'</a><img src="'+e.picURL+'"><p>'+e.price+"</p><p>"+e.hoursLeft+" hours left</p>"}).join("<br>"),t={htmlBody:r,subject:ebayOptions.query};(0,_mailer2["default"])(t)}else{var t={htmlBody:"No items found!",subject:ebayOptions.query};(0,_mailer2["default"])(t)}})},function(){},(!0),"America/Los_Angeles");
"use strict";var fs=require("fs"),nodemailer=require("nodemailer"),config=JSON.parse(fs.readFileSync("src/config.json"));module.exports=function(e){var r=nodemailer.createTransport({service:"gmail",secure:!1,port:25,auth:{user:config.email,pass:config.password},tls:{rejectUnauthorized:!1}}),o={from:config.email,to:config.email,subject:e.subject,html:e.htmlBody};r.sendMail(o,function(e,r){e&&console.log("Error occurred. "+e),console.log("Message sent: %s",r)})};